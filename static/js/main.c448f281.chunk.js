(this["webpackJsonpdictionary-management"]=this["webpackJsonpdictionary-management"]||[]).push([[0],{31:function(e,t,a){e.exports=a(47)},38:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n,i=a(0),r=a.n(i),c=a(25),u=a.n(c),l=a(16),o=a(13),s=a(4),d=a(29),v=a(30),f=a(5),y=a(6),m=a(22),b=a(19),p=a.n(b),h=function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},g=Object(i.createContext)({dictionaries:[{id:"",name:""}],structures:{},service:{addDictionary:function(e){},deleteDictionary:function(e){},addPair:function(e,t){t.key,t.value},deletePair:function(e,t){},updatePair:function(e,t){t.id,t.key,t.value},updateStructure:function(e,t){}}}),w=function(e){var t=e.initialState,a=e.children,n=Object(i.useState)(t.dictionaries||[]),c=Object(s.a)(n,2),u=c[0],l=c[1],o=Object(i.useState)(t.structures||{}),b=Object(s.a)(o,2),w=b[0],_=b[1],O=Object(i.useMemo)((function(){return{addDictionary:function(e){var t=p()();l((function(a){var n=[].concat(Object(m.a)(a),[{id:t,name:e}]);return h("dictionaries",n),n})),_((function(e){var a=Object(y.a)({},e,Object(f.a)({},t,[]));return h("structures",a),a}))},deleteDictionary:function(e){l((function(t){var a=t.filter((function(t){return t.id!==e}));return h("dictionaries",a),a})),_((function(t){t[e];var a=Object(d.a)(t,[e].map(v.a));return h("structures",a),a}))},addPair:function(e,t){var a=t.key,n=t.value,i=p()();_((function(t){return Object(y.a)({},t,Object(f.a)({},e,[].concat(Object(m.a)(t[e]),[{id:i,key:a,value:n,warnings:[]}])))}))},deletePair:function(e,t){_((function(a){return Object(y.a)({},a,Object(f.a)({},e,a[e].filter((function(e){return e.id!==t}))))}))},updatePair:function(e,t){var a=t.id,n=t.key,i=t.value;_((function(t){return Object(y.a)({},t,Object(f.a)({},e,t[e].map((function(e){return e.id!==a?e:{id:a,key:n,value:i,warnings:[]}}))))}))},updateStructure:function(e,t){_((function(a){var n=Object(y.a)({},a,Object(f.a)({},e,t));return h("structures",n),n}))}}}),[]);return r.a.createElement(g.Provider,{value:{dictionaries:u,structures:w,service:O}},a)},_=function(){return Object(i.useContext)(g)},O=(a(38),function(){var e=_().service,t=Object(i.useState)(""),a=Object(s.a)(t,2),n=a[0],c=a[1],u=Object(i.useCallback)((function(e){c(e.target.value)}),[]),l=Object(i.useCallback)((function(t){t.preventDefault(),e.addDictionary(n),c("")}),[n,e]);return r.a.createElement("form",{className:"overview__form",onSubmit:l},r.a.createElement("input",{className:"overview__input","data-testid":"newValue",value:n,onChange:u}),r.a.createElement("button",{className:"overview__button--add","data-testid":"add"},"+ Add"))}),j=function(){var e=_(),t=e.dictionaries,a=e.service,n=Object(i.useCallback)((function(e){return function(){a.deleteDictionary(e)}}),[a]);return r.a.createElement("section",{className:"overview"},r.a.createElement("header",null,"Overview"),r.a.createElement("ul",{className:"overview__list"},t.map((function(e){return r.a.createElement("li",{className:"overview__item",key:e.id},r.a.createElement(l.b,{className:"overview__item-link",to:"/".concat(e.id)},e.name),r.a.createElement("button",{className:"overview__button--delete","data-testid":"delete-".concat(e.id),title:"Delete dictionary",onClick:n(e.id)},"x"))}))),r.a.createElement(O,null))},k=a(28),E=a.n(k),N=a(7),S=a(8),C=a(11),x=a(10),D=a(12);!function(e){e[e.none=0]="none",e[e.duplicate=1]="duplicate",e[e.fork=2]="fork",e[e.chain=3]="chain",e[e.loop=4]="loop"}(n||(n={}));var J,I=function(){function e(t,a){Object(N.a)(this,e),this.pairs=t,this.watningLevel=a,this.dictionary=new Map,this.buildDictionary()}return Object(S.a)(e,[{key:"buildDictionary",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,i=this.pairs[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var r=n.value,c=this.dictionary.get(r.key);c||(c=new Set,this.dictionary.set(r.key,c)),c.add(r.value)}}catch(u){t=!0,a=u}finally{try{e||null==i.return||i.return()}finally{if(t)throw a}}}}]),e}(),M=function(e){function t(e){return Object(N.a)(this,t),Object(C.a)(this,Object(x.a)(t).call(this,e,n.duplicate))}return Object(D.a)(t,e),Object(S.a)(t,[{key:"markWarnings",value:function(){var e=new Map,t=new Map,a=!0,n=!1,i=void 0;try{for(var r,c=this.pairs[Symbol.iterator]();!(a=(r=c.next()).done);a=!0){var u=r.value,l=t.get(u.key);l||(l=new Set,t.set(u.key,l)),l.has(u.value)&&e.set(JSON.stringify(u),this.watningLevel),l.add(u.value)}}catch(o){n=!0,i=o}finally{try{a||null==c.return||c.return()}finally{if(n)throw i}}return e}}]),t}(I),L=function(e){function t(e){return Object(N.a)(this,t),Object(C.a)(this,Object(x.a)(t).call(this,e,n.fork))}return Object(D.a)(t,e),Object(S.a)(t,[{key:"markWarnings",value:function(){var e=new Map,t=!0,a=!1,n=void 0;try{for(var i,r=this.dictionary[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var c=i.value,u=Object(s.a)(c,2),l=u[0],o=u[1];if(o.size>1){var d=!0,v=!1,f=void 0;try{for(var y,m=o.keys()[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var b=y.value;e.set(JSON.stringify({key:l,value:b}),this.watningLevel)}}catch(p){v=!0,f=p}finally{try{d||null==m.return||m.return()}finally{if(v)throw f}}}}}catch(p){a=!0,n=p}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}return e}}]),t}(I),P=function(e){function t(e){return Object(N.a)(this,t),Object(C.a)(this,Object(x.a)(t).call(this,e,n.chain))}return Object(D.a)(t,e),Object(S.a)(t,[{key:"markWarnings",value:function(){var e=new Map,t=!0,a=!1,n=void 0;try{for(var i,r=this.pairs[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var c=i.value;if(void 0!==this.dictionary.get(c.value)){e.set(JSON.stringify(c),this.watningLevel);var u=!0,l=!1,o=void 0;try{for(var s,d=this.dictionary.get(c.value)[Symbol.iterator]();!(u=(s=d.next()).done);u=!0){var v=s.value;e.set(JSON.stringify({key:c.value,value:v}),this.watningLevel)}}catch(f){l=!0,o=f}finally{try{u||null==d.return||d.return()}finally{if(l)throw o}}}}}catch(f){a=!0,n=f}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}return e}}]),t}(I);!function(e){e[e.white=0]="white",e[e.gray=1]="gray",e[e.black=2]="black"}(J||(J={}));var W=function(e){function t(e){return Object(N.a)(this,t),Object(C.a)(this,Object(x.a)(t).call(this,e,n.loop))}return Object(D.a)(t,e),Object(S.a)(t,[{key:"findLoop",value:function(e,t,a,n){if(t.get(e)!==J.black)if(t.get(e)!==J.gray){t.set(e,J.gray),a.push(e);var i=this.dictionary.get(e);if(i){var r=!0,c=!1,u=void 0;try{for(var l,o=i[Symbol.iterator]();!(r=(l=o.next()).done);r=!0){var s=l.value;this.findLoop(s,t,a,n)}}catch(v){c=!0,u=v}finally{try{r||null==o.return||o.return()}finally{if(c)throw u}}}a.pop(),t.set(e,J.black)}else{var d=a.indexOf(e);n.push(a.slice(d))}}},{key:"markWarnings",value:function(){var e=this,t=new Map,a=new Map,n=!0,i=!1,r=void 0;try{for(var c,u=this.dictionary.keys()[Symbol.iterator]();!(n=(c=u.next()).done);n=!0){var l=c.value,o=!0,s=!1,d=void 0;try{for(var v,f=this.dictionary.keys()[Symbol.iterator]();!(o=(v=f.next()).done);o=!0){var y=v.value;a.set(y,J.white)}}catch(b){s=!0,d=b}finally{try{o||null==f.return||f.return()}finally{if(s)throw d}}var m=[];this.findLoop(l,a,[],m),m.forEach((function(a){for(var n=1;n<a.length;n++)t.set(JSON.stringify({key:a[n-1],value:a[n]}),e.watningLevel);t.set(JSON.stringify({key:a[a.length-1],value:a[0]}),e.watningLevel)}))}}catch(b){i=!0,r=b}finally{try{n||null==u.return||u.return()}finally{if(i)throw r}}return t}}]),t}(I),V=function(e,t,a){var n=Object(i.useState)(!1),r=Object(s.a)(n,2),c=r[0],u=r[1];return Object(i.useEffect)((function(){if(void 0!==e&&void 0!==t){u(!0);var n=t.map((function(e){return{key:e.key,value:e.value}})),i=[new M(n),new L(n),new P(n),new W(n)].map((function(e){return e.markWarnings()})),r=!1,c=t.map((function(e){var t=i.reduce((function(t,a){var n=a.get(JSON.stringify({key:e.key,value:e.value}));return n&&t.push(n),t}),[]);return t=t.length?t:[0],JSON.stringify(t)===JSON.stringify(e.warnings)?e:(r=!0,Object(y.a)({},e,{warnings:t}))}));r&&a(e,c),u(!1)}}),[e,t,a]),{isValidating:c}},A=(a(44),function(){var e=_().service,t=Object(o.f)().dictionaryId,a=Object(i.useState)({key:"",value:""}),n=Object(s.a)(a,2),c=n[0],u=n[1],l=Object(i.useCallback)((function(e){var t=Object(y.a)({},c,Object(f.a)({},e.target.name,e.target.value));u(t)}),[c]),d=Object(i.useCallback)((function(a){a.preventDefault(),t&&(e.addPair(t,c),u({key:"",value:""}))}),[e,c,t]);return r.a.createElement("form",{className:"dictionary__form",onSubmit:d},r.a.createElement("input",{className:"dictionary__input","data-testid":"key",value:c.key,name:"key",onChange:l}),r.a.createElement("input",{className:"dictionary__input","data-testid":"value",value:c.value,name:"value",onChange:l}),r.a.createElement("button",{className:"dictionary__button--add","data-testid":"add"},"+ Add"))}),F=r.a.memo((function(e){var t=e.item,a=e.updateItem,n=e.deleteItem,i=Object(o.f)().dictionaryId,c=function(e){var n=Object(y.a)({},t,Object(f.a)({},e.target.name,e.target.value));i&&a(i,n)};return r.a.createElement("div",{className:"dictionary__item","data-testid":"item-".concat(t.id)},r.a.createElement("input",{className:"dictionary__item-input",value:t.key,name:"key",onChange:c}),r.a.createElement("input",{className:"dictionary__item-input",value:t.value,name:"value",onChange:c}),r.a.createElement("button",{className:"dictionary__button--delete","data-testid":"delete-".concat(t.id),onClick:function(){i&&n(i,t.id)}},"x"),r.a.createElement("div",{className:"dictionary__warning-wrapper"},(t.warnings||[]).map((function(e){return r.a.createElement("span",{key:e,className:E()("dictionary__warning","dictionary__warning--".concat(e))})}))))})),z=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h6",null,"Instructions"),r.a.createElement("div",{className:"instruction__item dictionary__warning-wrapper"},r.a.createElement("span",{className:"dictionary__warning dictionary__warning--0"})," No warnings"),r.a.createElement("div",{className:"instruction__item dictionary__warning-wrapper"},r.a.createElement("span",{className:"dictionary__warning dictionary__warning--1"})," ","Duplicate"),r.a.createElement("div",{className:"instruction__item dictionary__warning-wrapper"},r.a.createElement("span",{className:"dictionary__warning dictionary__warning--2"})," Fork"),r.a.createElement("div",{className:"instruction__item dictionary__warning-wrapper"},r.a.createElement("span",{className:"dictionary__warning dictionary__warning--3"})," Chain"),r.a.createElement("div",{className:"instruction__item dictionary__warning-wrapper"},r.a.createElement("span",{className:"dictionary__warning dictionary__warning--4"})," Cycle"))},B=function(){var e=Object(o.f)().dictionaryId,t=_(),a=t.dictionaries,n=t.structures,c=t.service,u=Object(i.useMemo)((function(){return a.find((function(t){return t.id===e}))}),[e,a]),l=Object(i.useMemo)((function(){return e?n[e]:[]}),[e,n]),s=V(e,l,c.updateStructure).isValidating;return u?r.a.createElement("section",{className:"dictionary"},r.a.createElement("header",null,"Dictionary: ",u.name),r.a.createElement("div",{className:"dictionary__list"},l.map((function(e){return r.a.createElement(F,{key:e.id,item:e,updateItem:c.updatePair,deleteItem:c.deletePair})}))),r.a.createElement(A,null),s&&r.a.createElement("span",null,"Validation..."),r.a.createElement("footer",null,r.a.createElement(z,null))):r.a.createElement("div",null,"Dictionary is not found")},q=(a(45),function(){var e=function(){var e,t;try{e=JSON.parse(window.localStorage.getItem("dictionaries")||"[]"),t=JSON.parse(window.localStorage.getItem("structures")||"{}")}finally{}return{dictionaries:e,structures:t}}(),t=e.dictionaries,a=e.structures;return r.a.createElement(w,{initialState:{dictionaries:t,structures:a}},r.a.createElement(l.a,null,r.a.createElement("header",null,r.a.createElement(l.b,{className:"app__header",to:"/"},"Dictionary Management")),r.a.createElement(o.c,null,r.a.createElement(o.a,{path:"/:dictionaryId"},r.a.createElement(B,null)),r.a.createElement(o.a,{path:"/"},r.a.createElement(j,null)))))});a(46);u.a.render(r.a.createElement(q,null),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.c448f281.chunk.js.map